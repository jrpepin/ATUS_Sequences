setwd("C:/Users/Joanna/Dropbox/Repositories/ATUS_Sequences")
# Load libraries
library(ipumsr)
library(dplyr, warn.conflicts = FALSE)
ddi <- read_ipums_ddi("atus_00026.xml")
ddi <- read_ipums_ddi("atus_00030.xml")
data <- read_ipums_micro(ddi)
View(data)
ddi <- read_ipums_ddi("atus_00031.xml")
data <- read_ipums_micro(ddi)
table(data#rectype)
)
table(data$rectype)
table(data$RECTYPE)
data <- data %>% rename_all(tolower)
### Check-out the variable names
names(data)
data <- data %>%
mutate( rectype    = as.integer(lbl_clean(rectype)),
year       = as.integer(lbl_clean(year)),
caseid     = as.character(lbl_clean(caseid)),
hh_size    = as.integer(lbl_clean(hh_size)),
pernum     = as.integer(lbl_clean(pernum)),
lineno     = as.integer(lbl_clean(lineno)),
lineno_cps8 = as.integer(lbl_clean(lineno_cps8)),
presence   = as.integer(lbl_clean(presence)),
day        = as_factor(lbl_clean(day)),
wt06       = as.integer(lbl_clean(wt06)),
age        = as.integer(lbl_clean(age)),
sex        = as_factor(lbl_clean(sex)),
race       = as_factor(lbl_clean(race)),
hispan     = as_factor(lbl_clean(hispan)),
marst      = as_factor(lbl_clean(marst)),
relate     = as_factor(lbl_clean(relate)),
educ       = as.integer(lbl_clean(educ)),
educyrs    = as.integer(lbl_clean(educyrs)),
empstat    = as_character(lbl_clean(empstat)),
clwkr      = as_character(lbl_clean(clwkr)),
fullpart   = as.character(lbl_clean(fullpart)),
uhrsworkt  = as.integer(lbl_clean(uhrsworkt)),
spousepres = as_factor(lbl_clean(spousepres)),
actline    = as.integer(lbl_clean(actline)),
activity   = as.character(lbl_clean(activity)))
## Load libraries
library(ipumsr)
library(tidyverse, warn.conflicts = FALSE)
## Load ATUS Data into R
ddi <- read_ipums_ddi("atus_00031.xml")
data <- read_ipums_micro(ddi)
## Make the variable names lowercase
data <- data %>% rename_all(tolower)
### Check-out the variable names
names(data)
data <- data %>%
mutate( rectype    = as.integer(lbl_clean(rectype)),
year       = as.integer(lbl_clean(year)),
caseid     = as.character(lbl_clean(caseid)),
hh_size    = as.integer(lbl_clean(hh_size)),
pernum     = as.integer(lbl_clean(pernum)),
lineno     = as.integer(lbl_clean(lineno)),
lineno_cps8 = as.integer(lbl_clean(lineno_cps8)),
presence   = as.integer(lbl_clean(presence)),
day        = as_factor(lbl_clean(day)),
wt06       = as.integer(lbl_clean(wt06)),
age        = as.integer(lbl_clean(age)),
sex        = as_factor(lbl_clean(sex)),
race       = as_factor(lbl_clean(race)),
hispan     = as_factor(lbl_clean(hispan)),
marst      = as_factor(lbl_clean(marst)),
relate     = as_factor(lbl_clean(relate)),
educ       = as.integer(lbl_clean(educ)),
educyrs    = as.integer(lbl_clean(educyrs)),
empstat    = as.character(lbl_clean(empstat)),
clwkr      = as.character(lbl_clean(clwkr)),
fullpart   = as.character(lbl_clean(fullpart)),
uhrsworkt  = as.integer(lbl_clean(uhrsworkt)),
spousepres = as_factor(lbl_clean(spousepres)),
actline    = as.integer(lbl_clean(actline)),
activity   = as.character(lbl_clean(activity)))
## Change NA to 0 for duration minutes
data[["duration"]][is.na(data[["duration"]])] <- 0
summary(data$duration)
data[["activity"]][is.na(data[["activity"]])] <- "0"
summary(data$activity)
## Check that duration = 1440
data %>%
group_by(caseid) %>%
summarise(total= sum(duration))
data$actcat                     <-NA
# Childcare
ccare <- data$activity %in% c(
"30101" ,	"30102" ,	"30103" ,	"30104" ,	"30105" ,	"30108" ,	"30109" ,	"30110" ,
"30111" ,	"30112" ,	"30199" ,	"30201" ,	"30202" ,	"30203" ,	"30204" ,	"30299" ,
"30301" ,	"30302" ,	"30303" ,	"30399" ,	"30186")
# Housework
hswrk <- data$activity %in% c(
"20101" ,	"20102" ,	"20103" ,	"20104" ,	"20199")
leisure <- data$activity %in% c(
"120101" , "120199" , "120201" , 	"120202" , 	"120299" , 	"120401" , 	"120402" , 	"120403" ,
"120404" , "120405" ,	"120499" , 	"120501" , 	"120502" , 	"120504" , 	"120599" ,	"130201" ,
"130202" , "130203" ,	"130204" ,	"130205" ,	"130206" , 	"130207" , 	"130208" ,	"130209" ,
"130210" , "130211" ,	"130212" , 	"130213" , 	"130214" ,	"130215" ,	"130216" ,	"130217" ,
"130218" , "130219" ,	"130220" ,	"130221" ,	"130222" ,	"130223" ,	"130224" ,	"130225" ,
"130226" , "130227" ,	"130228" ,	"130229" ,	"130230" ,	"130231" ,	"130232" ,	"130299" ,
"130302" , "130402" , "120307" ,	"120309" ,	"120310" ,	"120311" ,	"120312" ,	"120313" ,
"130101" , "130102" ,	"130103" ,	"130104" ,	"130105" ,	"130106" ,	"130107" ,	"130108" ,
"130109" , "130110" ,	"130111" ,	"130112" ,	"130113" ,	"130114" ,	"130115" ,	"130116" ,
"130117" , "130118" ,	"130119" ,	"130120" ,	"130121" ,	"130122" ,	"130123" ,	"130124" ,
"130125" , "130126" ,	"130127" ,	"130128" ,	"130129" ,	"130130" ,	"130131" ,	"130132" ,
"130133" , "130134" ,	"130135" ,	"130136" ,	"130199" ,	"130201" ,	"130301" ,	"130401" ,
"130499" , "120301" , "120302" ,	"120303" ,	"120304" ,	"120305" ,	"120306" ,	"120308" ,
"120399" , "120503" , "129999" ,	"130399" ,	"139999" ,	"160101" ,	"160102" ,	"181201" ,
"181202" , "181204" ,	"181283" ,	"181299" ,	"181301" ,	"181302" ,	"181399")
sleep <- data$activity %in% c(
"10101" , "10102" ,  "10199")
remove(ccare)
remove(hswrk)
remove(leisure)
remove(sleep)
selfcare <- data$activity %in% c(
"10101"  ,  "10102"  ,  "10199"  ,  "10201"  ,  "10299"  ,  "10301"  ,  "10399"  ,  "10401"  ,
"10499"  ,  "10501"  ,  "10599"  ,  "19999"  ,  "80501"  ,  "80502"  ,  "80599"  ,  "181101" ,
"181199" )
eating <- data$activity %in% c(
"110101"  , "110199"  , "110281"  , "110289"  , "119999"  , "181101"  , "181199" )
workedu <- data$activity %in% c(
"50101"  ,  "50102"  ,  "50103"  ,  "50189"  ,  "50201"  ,  "50202"  ,  "50203"  ,  "50204"  ,
"50289"  ,  "50301"  ,  "50302"  ,  "50303"  ,  "50304"  ,  "50389"  ,  "50481"  ,  "50403"  ,
"50404"  ,  "50405"  ,  "50499"  ,  "59999"  ,  "60101"  ,  "60102"  ,  "60103"  ,  "60104"  ,
"60199"  ,  "60201"  ,  "60202"  ,  "60203"  ,  "60289"  ,  "60301"  ,  "60302"  ,  "60303"  ,
"60399"  ,  "60401"  ,  "60402"  ,  "60403"  ,  "60499"  ,  "69999"  ,  "160103" ,  "180501" ,
"180502" ,  "180589" ,  "180601" ,  "180682" ,  "180699" )
allcare <- data$activity %in% c(
"30101"  ,  "30102"  ,  "30103"  ,  "30104"  ,  "30105"  ,  "30186"  ,  "30108"  ,  "30109"  ,
"30110"  ,  "30111"  ,  "30112"  ,  "30199"  ,  "30201"  ,  "30202"  ,  "30203"  ,  "30204"  ,
"30299"  ,  "30301"  ,  "30302"  ,  "30303"  ,  "30399"  ,  "30401"  ,  "30402"  ,  "30403"  ,
"30404"  ,  "30405"  ,  "30499"  ,  "30501"  ,  "30502"  ,  "30503"  ,  "30504"  ,  "30599"  ,
"80101"  ,  "80102"  ,  "80199"  ,  "180381" ,  "180382" ,  "180399" )
hwork <- data$activity %in% c(
"20101"  ,  "20102"  ,  "20103"  ,  "20104"  ,  "20199"  ,  "20201"  ,  "20202"  ,  "20203"  ,
"20299"  ,  "20301"  ,  "20302"  ,  "20303"  ,  "20399"  ,  "20401"  ,  "20402"  ,  "20499"  ,
"20501"  ,  "20502"  ,  "20599"  ,  "20681"  ,  "20699"  ,  "20701"  ,  "20799"  ,  "20801"  ,
"20899"  ,  "20901"  ,  "20902"  ,  "20903"  ,  "20904"  ,  "20905"  ,  "20999"  ,  "80201"  ,
"80202"  ,  "80203"  ,  "80299"  ,  "80701"  ,  "80702"  ,  "80799"  ,  "90101"  ,  "90102"  ,
"90103"  ,  "90104"  ,  "90199"  ,  "90201"  ,  "90202"  ,  "90299"  ,  "90301"  ,  "90302"  ,
"90399"  ,  "90401"  ,  "90402"  ,  "90499"  ,  "90501"  ,  "90502"  ,  "90599"  ,  "99999"  ,
"70101"  ,  "180701" ,  "180904" ,  "180807" ,  "180903" ,  "80699"  ,  "160106" )
## Passive leisure
passleis <- data$activity %in% c(
"120301"  , "120302"  , "120303"  , "120304"  , "120305"  , "120306"  , "120307"  , "120308"  ,
"120503"  , "120399"  )
data$actcat                     <-NA
data$actcat[selfcare]           <- "Sleep & Self-care"
data$actcat[eating]             <- "Eating"
data$actcat[workedu]            <- "Work & Edu"
data$actcat[allcare]            <- "Carework"
data$actcat[hwork]              <- "Housework"
data$actcat[passleis]           <- "Passive Leisure"
data$actcat[is.na(data$actcat)] <- "Other"
data$actcat <- as.character(data$actcat)
